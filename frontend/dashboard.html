<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sentinel Auth Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&family=Space+Grotesk:wght@400;500;700&display=swap"
        rel="stylesheet">
</head>

<body>
    <canvas id="ambient-canvas" class="ambient-canvas" aria-hidden="true"></canvas>
    <div class="page-backdrop-title" data-background-title>Sentinel Auth</div>
    <div class="page-shell">
        <main class="layout">
            <nav class="topbar panel">
                <a class="brand-link" href="/">Sentinel Auth</a>
                <div class="topbar-links">
                    <a class="topbar-link" href="/activity.html">Dashboard</a>
                    <a class="topbar-link topbar-link-active" href="/dashboard.html">Keys</a>
                    <a class="topbar-link" href="/documentation/index.html">Documentation</a>
                    <a class="topbar-link" href="/agent.html">Agent Demo</a>
                </div>
            </nav>

            <section id="dashboard-view" class="dashboard-shell">
                <section class="hero panel">
                    <div class="dashboard-hero-header">
                        <div>
                            <p class="eyebrow">Dashboard</p>
                            <h1>Your Sentinel workspace for keys, policies, and verification tests.</h1>
                            <p id="session-meta" class="hero-copy">Account session active. You can issue and manage API
                                keys from this dashboard.</p>
                        </div>
                        <div class="dashboard-hero-actions">
                            <div class="output-card compact-card">
                                <h3>Signed in as</h3>
                                <code id="account-summary">Not signed in.</code>
                            </div>
                            <div class="output-card compact-card compact-2fa-card">
                                <h3>Verify Your Account 2FA</h3>
                                <p id="phone-2fa-summary" class="muted">No verified phone number.</p>
                            </div>
                            <button id="open-phone-2fa-button" class="btn btn-secondary" type="button">Verify
                                phone</button>
                            <button id="logout-button" class="btn btn-ghost" type="button" disabled>Logout</button>
                        </div>
                    </div>
                </section>

                <section id="phone-2fa-overlay" class="auth-overlay auth-overlay-hidden" aria-hidden="true">
                    <div class="auth-backdrop"></div>
                    <div class="auth-dialog panel phone-2fa-dialog">
                        <div class="auth-dialog-header">
                            <div>
                                <p class="eyebrow">Security</p>
                                <h2>Verify your account 2FA</h2>
                            </div>
                            <button id="close-phone-2fa-button" class="btn btn-ghost btn-close"
                                type="button">Close</button>
                        </div>
                        <p class="muted">Optional 2FA setup. Verify a phone number on your account so you can use it as
                            an additional security contact.</p>
                        <div class="output-card">
                            <h3>Current status</h3>
                            <p id="phone-2fa-status" class="muted">Request a code, then confirm it here. In mock mode
                                the code is shown in the status message.</p>
                        </div>
                        <form id="phone-2fa-form" class="stack">
                            <label>
                                <span>Phone number</span>
                                <input id="phone-2fa-number" type="tel" placeholder="+1 555 555 5555" required>
                            </label>
                            <div class="action-row">
                                <button id="phone-2fa-request-button" class="btn btn-secondary" type="button">Send
                                    code</button>
                                <button id="phone-2fa-verify-button" class="btn btn-primary" type="submit">Verify
                                    code</button>
                            </div>
                            <label>
                                <span>Verification code</span>
                                <input id="phone-2fa-code" type="text" inputmode="numeric" placeholder="6-digit code"
                                    minlength="4" maxlength="12" required>
                            </label>
                        </form>
                    </div>
                </section>

                <section class="grid">
                    <section class="panel">
                        <div class="section-heading">
                            <p class="eyebrow">Account</p>
                            <h2>Issued API keys</h2>
                        </div>
                        <p class="muted">Each key is associated with your account. The plaintext value is only shown
                            when a key is created.</p>
                        <div id="api-key-list" class="dashboard-list">
                            <div class="empty-state">No keys issued yet.</div>
                        </div>
                    </section>

                    <section class="panel">
                        <div class="section-heading">
                            <p class="eyebrow">Step 1</p>
                            <h2>Generate a key</h2>
                        </div>
                        <form id="issue-key-form" class="stack">
                            <label>
                                <span>App name</span>
                                <input id="app-name" type="text" placeholder="Atlas Agent Ops" required>
                            </label>
                            <label>
                                <span>Owner name</span>
                                <input id="owner-name" type="text" placeholder="Optional">
                            </label>
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:14px;">
                                <label>
                                    <span>Wallet label</span>
                                    <input id="wallet-label" type="text" placeholder="e.g. GPT Agent" required>
                                </label>
                                <label>
                                    <span>Wallet address</span>
                                    <input id="wallet-address" type="text" placeholder="Solana address" required>
                                </label>
                            </div>
                            <label>
                                <span>Use case</span>
                                <textarea id="use-case" rows="4"
                                    placeholder="Describe what your AI agents will manage."></textarea>
                            </label>
                            <button id="issue-key-button" class="btn btn-primary" type="submit" disabled>Issue API
                                key</button>
                        </form>

                        <div class="output-card">
                            <div class="output-header">
                                <h3>Latest issued key</h3>
                                <button id="copy-key-button" class="btn btn-ghost" type="button" disabled>Copy</button>
                            </div>
                            <code id="issued-key">Issue a key to see it here.</code>
                            <p id="issued-key-meta" class="muted">The plaintext key is only returned once.</p>
                        </div>
                    </section>
                </section>

                <section class="grid">
                    <section class="panel">
                        <div class="section-heading">
                            <p class="eyebrow">Solana</p>
                            <h2>Linked wallets</h2>
                        </div>
                        <p class="muted">Connect Phantom to link a real Solana wallet to this account. The dashboard
                            will load its balance and recent transaction record.</p>
                        <div class="action-row">
                            <button id="connect-wallet-button" class="btn btn-secondary" type="button" disabled>Connect
                                Phantom</button>
                            <button id="refresh-wallet-button" class="btn btn-ghost" type="button" disabled>Refresh
                                wallet</button>
                        </div>
                        <div id="wallet-status" class="muted">No wallet linked yet.</div>
                        <div id="wallet-list" class="dashboard-list">
                            <div class="empty-state">No wallets linked to this account.</div>
                        </div>
                    </section>

                    <section class="panel">
                        <div class="section-heading">
                            <p class="eyebrow">Wallet View</p>
                            <h2>On-chain overview</h2>
                        </div>
                        <div class="summary-grid">
                            <div class="summary-card">
                                <span class="summary-label">Wallet</span>
                                <code id="wallet-address-label">No wallet selected.</code>
                            </div>
                            <div class="summary-card">
                                <span class="summary-label">Balance</span>
                                <strong id="wallet-balance-label">0 SOL</strong>
                            </div>
                            <div class="summary-card">
                                <span class="summary-label">Network</span>
                                <strong id="wallet-network-label">Not loaded</strong>
                            </div>
                            <div class="summary-card">
                                <span class="summary-label">Last sync</span>
                                <strong id="wallet-last-sync">Not synced</strong>
                            </div>
                        </div>
                        <div class="output-card">
                            <div class="output-header">
                                <h3>Recent transactions</h3>
                                <button id="unlink-wallet-button" class="btn btn-ghost" type="button" disabled>Unlink
                                    selected wallet</button>
                            </div>
                            <div id="wallet-transaction-list" class="dashboard-list">
                                <div class="empty-state">Link a wallet to load recent transactions.</div>
                            </div>
                        </div>
                    </section>
                </section>

                <section class="grid">
                    <section class="panel">
                        <div class="section-heading">
                            <p class="eyebrow">Step 2</p>
                            <h2>Quickstart</h2>
                        </div>
                        <div class="snippet-group">
                            <div class="snippet-header">
                                <h3>cURL</h3>
                                <button id="copy-curl-button" class="btn btn-ghost" type="button" disabled>Copy</button>
                            </div>
                            <pre id="curl-snippet"
                                class="snippet">Issue a key to generate a ready-to-run cURL example.</pre>
                        </div>
                        <div class="snippet-group">
                            <div class="snippet-header">
                                <h3>JavaScript</h3>
                                <button id="copy-js-button" class="btn btn-ghost" type="button" disabled>Copy</button>
                            </div>
                            <pre id="js-snippet" class="snippet">Issue a key to generate a browser/server example.</pre>
                        </div>
                    </section>

                    <section class="panel">
                        <div class="section-heading">
                            <p class="eyebrow">Step 3</p>
                            <h2>Test your key</h2>
                        </div>
                        <div class="stack">
                            <label>
                                <span>Policy name</span>
                                <input id="custom-policy-name" type="text" value="Public portal starter policy">
                            </label>
                            <label>
                                <span>Max spend USD</span>
                                <input id="custom-spend-limit" type="number" value="5000" min="1" step="1">
                            </label>
                            <label>
                                <span>Max requests per minute</span>
                                <input id="custom-rate-limit" type="number" value="60" min="1" step="1">
                            </label>
                        </div>
                        <div class="action-row">
                            <button id="create-policy-button" class="btn btn-secondary" type="button" disabled>Create
                                starter policy</button>
                            <button id="run-authorize-button" class="btn btn-primary" type="button" disabled>Run sample
                                authorize</button>
                        </div>
                        <div class="output-card">
                            <h3>Current policy</h3>
                            <code id="policy-id-label">No policy created yet.</code>
                            <p class="muted">Open the Dashboard to inspect receipts, blocked requests, and verification
                                messages.</p>
                            <div class="action-row">
                                <a class="btn btn-ghost" href="/activity.html">Open Dashboard</a>
                            </div>
                        </div>
                    </section>
                </section>

                <section class="panel">
                    <div class="api-pricing-container"
                        style="display: grid; grid-template-columns: 1fr 1.2fr; gap: 40px;">
                        <div class="pricing-editor" style="border-right: 1px solid var(--line); padding-right: 20px;">
                            <div class="section-heading">
                                <p class="eyebrow">API Cost Tracking</p>
                                <h2>Database Editor</h2>
                            </div>
                            <p class="muted">Add known APIs and their cost per call so Sentinel can calculate spend
                                effectively.</p>

                            <form id="pricing-form" class="stack" style="margin-top: 1rem;">
                                <label>
                                    <span>Select API Key</span>
                                    <select id="pricing-client-id" required>
                                        <option value="">Loading keys...</option>
                                    </select>
                                </label>

                                <div id="pricing-fields" style="display: none;" class="stack">
                                    <label>
                                        <span>API Link / Model</span>
                                        <input id="pricing-api-link" type="text"
                                            placeholder="e.g. openai/v1/chat/completions" required>
                                    </label>

                                    <label>
                                        <span>Price per call (USD)</span>
                                        <input id="pricing-price-per-call" type="number" step="0.000001" min="0"
                                            placeholder="0.01" required>
                                    </label>

                                    <button id="save-pricing-btn" class="btn btn-secondary" type="submit">Save
                                        Pricing</button>
                                    <div id="pricing-status" class="muted" style="margin-top: 8px;"></div>
                                </div>
                            </form>
                        </div>
                        <div class="pricing-viewer" style="padding-left: 10px;">
                            <div class="section-heading">
                                <p class="eyebrow">Saved Values</p>
                                <h2>Recorded API Prices</h2>
                            </div>
                            <p class="muted">Prices for the selected key. Calls without a price will be denied.</p>
                            <div id="pricing-list" class="dashboard-list" style="max-height: 400px; overflow-y: auto;">
                                <div class="empty-state">Select a key to see saved prices.</div>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="panel">
                    <div class="section-heading">
                        <p class="eyebrow">Live Log</p>
                        <h2>Portal console</h2>
                    </div>
                    <div id="console-output" class="console"></div>
                </section>
            </section>
        </main>
    </div>

    <script type="module" src="/dashboard.js"></script>
    <script type="module" src="/background.js"></script>
</body>

</html>